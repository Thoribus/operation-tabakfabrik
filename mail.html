<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Letzte Hürde</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/style.css">
  <style>
    .hangman {
      text-align: center;
      margin-top: 30px;
    }

    .word {
      font-size: 1.5em;
      letter-spacing: 0.15em;
      margin: 20px 0;
      word-break: break-all;
    }

    .letters button {
      margin: 3px;
      padding: 6px 10px;
      cursor: pointer;
    }

    .status {
      margin-top: 15px;
    }

    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">

    <h1>LETZTE HÜRDE</h1>

    <p>
      Ahhh, du hast es also geschafft.
    </p>

    <p>
      Den letzten Teil der Einladung erhältst du,
      wenn du mir persönlich schreibst.
    </p>

    <p>
      Aber was ist da die richtige Adresse?
    </p>

    <hr>

    <div class="hangman">
        <pre id="gallow">
       +---+
       |   |
           |
           |
           |
           |
      =========
        </pre>
      
        <div class="word" id="wordDisplay"></div>
      
        <input
          type="text"
          id="letterInput"
          maxlength="1"
          placeholder="Buchstabe eingeben"
          style="text-align:center; font-size:1.2em; padding:6px;"
        >
      
        <div class="status" id="status"></div>
      
        <div id="success" class="hidden">
          <hr>
          <p>Kontaktadresse rekonstruiert.</p>
          <p><strong>Mission erfüllt.</strong></p>
        </div>
      
        <audio id="errorSound" src="audio/error.mp3"></audio>
        <audio id="successSound" src="audio/success.mp3"></audio>
      </div>
      
      

  </div>

  <script>
    const solution = "umwandlung.in.der.uckermark@gmail.com".toLowerCase();
    const visibleTail = "@gmail.com";
  
    let guessed = [];
    let errors = 0;
    const maxErrors = 8;
  
    const stages = [
  ` +---+
   |   |
       |
       |
       |
       |
  =========`,
  ` +---+
   |   |
   O   |
       |
       |
       |
  =========`,
  ` +---+
   |   |
   O   |
   |   |
       |
       |
  =========`,
  ` +---+
   |   |
   O   |
  /|   |
       |
       |
  =========`,
  ` +---+
   |   |
   O   |
  /|\\  |
       |
       |
  =========`,
  ` +---+
   |   |
   O   |
  /|\\  |
  /    |
       |
  =========`,
  ` +---+
   |   |
   O   |
  /|\\  |
  / \\  |
       |
  =========`,
  ` +---+
   |   |
  [O]  |
  /|\\  |
  / \\  |
       |
  =========`,
  ` +---+
   |   |
  [X]  |
  /|\\  |
  / \\  |
       |
  =========`
    ];
  
    const wordDisplay = document.getElementById("wordDisplay");
    const status = document.getElementById("status");
    const success = document.getElementById("success");
    const gallow = document.getElementById("gallow");
    const input = document.getElementById("letterInput");
    const errorSound = document.getElementById("errorSound");
    const successSound = document.getElementById("successSound");
  
    function renderWord() {
      let output = "";
      for (let char of solution) {
        if (char === "@") {
          output += visibleTail;
          break;
        }
  
        if (char === ".") {
          output += ".";
        } else if (guessed.includes(char)) {
          output += char;
        } else {
          output += "_";
        }
      }
      wordDisplay.textContent = output;
    }
  
    function handleInput() {
      const raw = input.value.toLowerCase();
      input.value = "";
  
      if (!raw.match(/[a-z]/)) return;
      if (guessed.includes(raw)) return;
  
      guessed.push(raw);
  
      if (!solution.includes(raw)) {
        errors++;
        gallow.textContent = stages[errors];
        errorSound.currentTime = 0;
        errorSound.play();
      } else {
        successSound.currentTime = 0;
        successSound.play();
      }
  
      renderWord();
      updateStatus();
      checkWin();
    }
  
    function updateStatus() {
      status.textContent = `Fehlversuche: ${errors} / ${maxErrors}`;
      if (errors >= maxErrors) {
        status.textContent = "Mission fehlgeschlagen. Seite neu laden, um es erneut zu versuchen.";
        input.disabled = true;
      }
    }
  
    function checkWin() {
      let won = true;
      for (let char of solution) {
        if (char === "@") break;
        if (char !== "." && !guessed.includes(char)) {
          won = false;
        }
      }
  
      if (won) {
        success.classList.remove("hidden");
        input.disabled = true;
      }
    }
  
    input.addEventListener("input", handleInput);
  
    renderWord();
    updateStatus();
  </script>
  
  

</body>
</html>
